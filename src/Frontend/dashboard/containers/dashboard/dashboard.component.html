<sb-layout-dashboard>
  <sb-top-nav title="Dashboard"></sb-top-nav>
  <sb-loader [isLoading]="isLoading"></sb-loader>
  <div>
    <p class="heading">Hello <span class="text-capitalize"> {{Name}}</span>, welcome back</p>
  </div>
<div class="toaster" (click)="hideToaster()">
  <div *ngIf="errorMessage && isPlanExpired == false" class="error">
    <p>{{ errorMessage}}</p>
    <div class="container">
      <div class="item" *ngFor="let detail of whatsAppDisplay; let i = index">
        <div class="channel">{{ detail.channel_id }}</div>
        <div class="number">({{ detail.connected_id }})</div>
      </div>
    </div>
  </div>

  <div *ngIf="errorMessage && isPlanExpired" class="error">
    <p>{{ errorMessage}}</p>
  </div>
  <p *ngIf="successMessage" class="success">{{successMessage}}</p>
  <p *ngIf="warningMessage" class="warning">{{warningMessage}}</p>
</div>
  <div  class="dashboard-filled-state" *ngIf="!settingsService.checkRoleExist('1')">

  <div class="row ">
      <div class="col-sm-8 pl-4 mt-5">
        <div class="row m-0">
          <div class="col-sm-6" >
            <div class="dash-card float-left pb-4">
              <span class="card-heading">Contacts</span>
              <div class="p-2 card-1-pb">
                <div>
                  <div class="card1 d-flex mx-4 my-3 pt-1">
                    <div class="dash-card-items mt-1 ">
                      <span class="item-heading">{{totalContacts}}</span>
                      <p class="mb-2 pb-2">Total Contacts</p>
                    </div>
                  </div>
                  <div class="card2 d-flex mx-4 my-3 pt-1">
                    <div class="dash-card-items mt-1">
                      <span class="item-heading">{{activeContacts}}</span>
                      <p class="mb-2 pb-2">Opt-In Contacts</p>
                    </div>
                  </div>
                  <div class="card3 d-flex mx-4 my-3 pt-1">
                    <div class="dash-card-items mt-1">
                      <span class="item-heading">{{inactiveContacts}}</span>
                      <p class="mb-2 pb-2">Opt-Out Contacts</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
  
          <div class="col-sm-6" >
            <div class="dash-card float-right">
              <span class="card-heading">Conversations</span>
              <div class="p-2">
                <div>
                  <div class="card1 d-flex mx-4 my-3 pt-1">
                    <div class="dash-card-items mt-1 ">
                      <span class="item-heading">{{totalInteractions}}</span>
                      <p class="mb-2 pb-2">Total Interactions</p>
                    </div>
                  </div>
                  <div class="card2 d-flex mx-4 my-3 pt-1">
                    <div class="dash-card-items mt-1">
                      <span class="item-heading">{{openInteractions}}</span>
                      <p class="mb-2 pb-2">Open Interactions</p>
                    </div>
                  </div>
                  <div class="card3 d-flex mx-4 my-3 pt-1">
                    <div class="dash-card-items mt-1">
                      <span class="item-heading">{{closedInteractions}}</span>
                      <p class="mb-2 pb-2">Resolved Interactions</p>
                    </div>
                  </div>
                </div>
                <span class="font-small">Note: Blocked conversations are not counted here.</span>
              </div>
            </div>
          </div>
        </div>
  
        <div class="row m-0 mt-5">
          <div class="campaign-card d-flex justify-content-between align-items-center" >
            <div class="p-3 w-100">
              <span class="card-heading ">Campaigns</span>
              <div class="row w-100 justify-content-around">
                <div class="campaign-card-item">
                  <img id="scheduledCampaign" class="dash-icons" src="../../../../assets/img/dashboard/total-camp.svg">
                  <div class="text-justify mt-4 ml-4">
                    <span class="item-heading">{{scheduledCampaign}}</span>
                    <p id="totalsche">Total Scheduled</p>
                  </div>
                </div>
                <div class="campaign-card-item">
                  <img id="completedCampaign" class="dash-icons" src="../../../../assets/img/dashboard/painding-camp.svg">
                  <div class="text-justify mt-4 ml-4">
                    <span class="item-heading">{{completedCampaign}}</span>
                    <p id="totaldraft">Total Completed</p>
                  </div>
                </div>
              </div>
              <div class="row w-100 justify-content-around">
                <div class="campaign-card-item running">
                  <img id="scheduledCampaign" class="dash-icons" src="../../../../assets/img/dashboard/deli-camp.svg">
                  <div class="text-justify mt-4 ml-4">
                    <span class="item-heading">{{runningCampaign}}</span>
                    <p id="totalsche">Total Running</p>
                  </div>
                </div>
                <div class="campaign-card-item draft">
                  <img class="dash-icons" src="../../../../assets/img/dashboard/failed-camp.svg">
                  <div class="text-justify mt-4 ml-4">
                    <span class="item-heading">{{draftCampaign}}</span>
                    <p id="totaldraft">Total Draft</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
  
        <div class="w-100 dash-card  mt-5">
          <div class="" >
            <span class="card-heading ">Agents</span>
            <div class="agent-items m-4">
              <div class="d-flex justify-content-around align-content-center">
                <div class="d-flex">
                  <img id="active-agent" class="m-0 dash-icons" src="../../../../assets/img/dashboard/Group 430.svg">
                  <div class="ml-4 mt-1 text-justify">
                    <span class="item-heading">{{totalAgents}}</span>
                    <p>Total Agents</p>
                  </div>
                </div>
  
  
                <div class="d-flex">
                  <img class="m-0 dash-icons" src="../../../../assets/img/dashboard/Group 431.svg">
                  <div class="ml-4 mt-1">
                    <span class="item-heading">{{activeAgents}}</span>
                    <p>Active Agents</p>
                  </div>
                </div>
                <div class="d-flex">
                  <img class="m-0 dash-icons" src="../../../../assets/img/dashboard/Group 432.svg">
                  <div class="ml-4 mt-1">
                    <span class="item-heading">{{inactiveAgents}}</span>
                    <p>Inactive Agents</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
  
      <div class="col-sm-4 p-0">
        <div class="card9 ">
          <div class="">
            <div class="px-3 pt-4">
              <span class="card-heading ">Recent conversations</span>
            </div>
            <div class="px-3">
              <div class="recentconversation" *ngFor="let items of recentConversation" >
                <div class="text-capitalize initials"> {{ items?.nameInitials }} </div>
                <div class="col-md-8 rc-body">
                  <p class="text-capitalize" id="item-name" [innerHTML]="items?.Name"></p>
                  <p id="item-message" class="ellipsis-1"  *ngIf="!['Document', 'Video', 'Image'].includes(getMediaType(items.media_type))" [innerHTML]=" SanitizeHtmlMessage(items?.message_text)"></p>
                  <p id="item-message" class="ellipsis-1" *ngIf="items.media_type != 'text'">
                    <img src="/assets/img/teambox/document-icon.svg" class="mr-2 item-message-media" *ngIf="getMediaType(items.media_type) == 'Document'">
                    <img src="/assets/img/teambox/video-icon.svg" class="mr-2 item-message-media" *ngIf="getMediaType(items.media_type) == 'Video'">
                    <img src="/assets/img/teambox/photo-icon.svg" class="mr-2 item-message-media" *ngIf="getMediaType(items.media_type) == 'Image'">
                    {{getMediaType(items.media_type)}}
                  </p>
                </div>
  
                <p id="item-date"><span *ngIf="items.isread == 0 && items.message_direction != 'Out'"><div class="red-dot"></div></span>{{settingsService.timeFormat =='12' ? (items.interaction_date | date:'h:mm a'):(items.interaction_date | date:'H:mm') }}</p>
              </div>
            </div>
  
            <!-- <div class="card10 pb-3 mx-5"  *ngIf="!settingsService.checkRoleExist('48')">
              <div class="card10-p">
               
                <img src="assets/img/img2.png" class="pb-3" alt="error">
                <p class="txt-1">Premium+</p>
                <p class="txt-2">₹0.50 per message</p>
              </div>
  
              <div class="card10-c mx-3 py-4">
                <p class="txt-1" style="margin-top:30px">Your available balance</p>
                <p class="txt-2" style=" font-size: 27px;"><b>₹{{availableAmount}}</b></p>
                <div class="col-sm-12">
                  <button [routerLink]="['/myprofile']">Add Funds</button>
                </div>
              </div>
            </div> -->
          </div>
        </div>
      </div>
  
    </div>
  </div>
  <div *ngIf="settingsService.checkRoleExist('1')" class="access-denied">
    <div class="text-center">
    <img src="../../../../assets/img/access-denied.svg" width="50px" height="50px">
    <div>Oops! Access to this content is denied</div>
  </div>
  </div>
</sb-layout-dashboard>