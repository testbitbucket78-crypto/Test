<sb-layout-dashboard>

	<sb-top-nav title="Bot Builder"></sb-top-nav>

	<div class="bot_page">
		<div class="header bot_section">

			<div class="bot_page_left">
				<input (keyup)="searchBotBuilder($event)" type="text" placeholder="Search" aria-label="Search"
					class="search-box" aria-describedby="basic-addon2" />
			</div>
			<div class="bot_page_right">
				<div class="D-whatsApp">
					<!-- <button class="D2-whatsApp" (click)="toggleAssignOption()">
						<span>
							<img class="icon" src="/assets/img/teambox/whatsapp-icon-l.svg" />
							{{channelSelected}} ({{channelPhoneNumber}})
							<img src="../../../../assets/img/arrow-down.svg" />
						</span>
					</button> -->
					<!-- <div *ngIf="ShowAssignOption" class="popup-dialog AssignOption p-15">
						<p *ngFor="let channel of channelOption" class="d-flex align-items-center px-2 py-1"
							(click)="updateDropdown(channel.connected_id)">
							<img class="icon" src="/assets/img/teambox/whatsapp-icon-l.svg" />
							<span class="text-capitalize initials">{{channel.label}} ({{channel.connected_id}})</span>
						</p>
					</div> -->
				</div>

				<div class="drop-down-btn">
					<div class="toggle-box" (click)="filterBot(filterBotId)">
						<img src="assets/img/teambox/filter-icon.svg">
						<span>Filter</span>
					</div>
				</div>
				<button class="new-message-btn" data-bs-toggle="modal" data-bs-target="#createBotModal"><img
						class="icon" src="/assets/img/teambox/add.svg" /> New Bot</button>

			</div>


		</div>


		<!-- <div class="bot_section"> -->
		<div class="tile-container">
			<div class="tile" *ngFor="let bot of botsList" (click)="toggleTemplatesData(bot)">
				<div class="tile-header">
					<span class="status" [style.background]="statusColors[bot?.status]">{{bot.status}}</span>
					<span class="id">Id: {{ bot.id }}</span>
				</div>

				<h3 class="title">{{ bot.name }}</h3>

				<p class="timestamp">Created On: {{ bot.created_at || 'NA'}}</p>
				<p class="timestamp">Invoked: {{ bot.invoked || 'NA'}}</p>
				<p class="timestamp">Completed: {{ bot.completed || 'NA' }}</p>
				<p class="timestamp">Dropped: {{ bot.dropped || 'NA' }}</p>


			</div>
		</div>




		<div *ngIf="showCampaignDetails" class="campaign_detail d-flex flex-column justify-content-between">
			<div class="modal-header filtercampaignheader">
				<div class="modal-header-left">
				</div>
				<div class="modal-header-right">
					<p class="close-box" (click)="toggleTemplatesData(null)"><img
							src="../../../../assets/img/teambox/icon-close.svg"></p>
				</div>
			</div>

			<div class="campaigns_section_item m-0" style="height: calc(100dvh - 160px); overflow: auto;">
				<div class="campaigns_section_item_header">
					<label [style.background]="statusColors[botDetailsData?.status]">{{botDetailsData?.status}}</label>
					<span>Bot ID : {{botDetailsData?.id}}</span>
				</div>
				<p class="start_time"><span>Created on:</span>
					{{settingsService?.getDateTimeFormate(botDetailsData?.created_at)}} <br>
					<span>Published On: </span>{{botDetailsData?.published_at
					?(settingsService?.getDateTimeFormate(botDetailsData?.published_at )): 'NA'}} <br>
					<span>Deprecated On: </span>{{botDetailsData?.deprecated_at
					?(settingsService?.getDateTimeFormate(botDetailsData?.deprecated_at )): 'NA'}}
				</p>
				<div class="campaigns_section_user">
					<div class="d-flex align-items-center user-img ">
						<img [src]="profilePicture" />
						<div class="img" *ngIf="!profilePicture">
							{{apiService.getInitials(botDetailsData?.created_By)}}</div>
						<p class="m-0">{{botDetailsData?.created_By}}</p>
					</div>
					<p><span>Created By</span></p>
				</div>
				<p class="title">{{botDetailsData?.name}}</p>
				<p><img class="icon"
						src="../../../../assets/img/teambox/whatsapp-icon-l.svg" />{{botDetailsData?.channel_id}}</p>
				<div class="d-flex w-100 pb-4 category_section">
					<div>
						<p>Description</p>
						<span>{{botDetailsData?.description || 'N/A'}}</span>
					</div>
					<div>
						<p>Bot Timeout</p>
						<span>{{botDetailsData?.timeout_value || 'N/A'}}</span>
					</div>

				</div>
				<div class="d-flex w-100 pb-4 category_section">
					<div>
						<p>Sessions Invoked</p>
						<span>{{botDetailsData?.description || 'N/A'}}</span>
					</div>
					<div>
						<p>Sessions Completed</p>
						<span>{{botDetailsData?.botTimeout || 'N/A'}}</span>
					</div>


				</div>

				<div class="d-flex w-100 pb-4 category_section">
					<div>
						<p>Sessions Dropped</p>
						<span>{{botDetailsData?.botTimeout || 'N/A'}}</span>
					</div>
				</div>
				<!-- <div class="category_section">
					<span class="sub_titles" >Advance Options</span>
						<p class="sub_title_sm">Timeout Message:</p>
						<span class="advanced_section"> {{botDetailsData?.ID || 'N/A'}}</span>
					</div> -->




				<div class="advance-options">
					<div class="advance-header" (click)="toggleOptions()">
						<span>Advance Options</span>
						<img src="../../../../assets/img/up-arrow.png" alt="Toggle" class="arrow-icon"
							[class.rotated]="showOptions" />
					</div>

					<div class="advance-body" *ngIf="showOptions">
						<div class="option">
							<div class="label timeout">Timeout Message</div>
							<div class="content">Your conversation with <b>{{ botDetailsData?.timeout_message }}</b>
								ended</div>
						</div>

						<div class="option">
							<div class="label timeout">Advance Action</div>
							<div class="content">Assign to Contact to Owner <b>{{ ownerName }}</b></div>
						</div>
					</div>
				</div>


				<div class="flex-row  pt-4 textcenter">
					<button class="new-token-btn w-auto mr-2 d-flex align-items-center downloadBtnEnabled"
						(click)="openModal(dateRangeModal);">
						<span>
							Export Bot Usage
						</span>
						<!-- <div class="btn-circle-download ml-2">
							<svg id="arrow" width="10px" height="16px" viewBox="17 14 14 20">
								<path d="M24,15 L24,32"></path>
								<polyline points="30 27 24 33 18 27"></polyline>
							</svg>
							<svg id="check" width="18px" height="12px" viewBox="13 17 21 15">
								<polyline points="32.5 18.5 20 31 14.5 25.5"></polyline>
							</svg>
							<svg id="border" width="25px" height="25px" viewBox="0 0 48 48">
								<path
									d="M24,1 L24,1 L24,1 C36.7025492,1 47,11.2974508 47,24 L47,24 L47,24 C47,36.7025492 36.7025492,47 24,47 L24,47 L24,47 C11.2974508,47 1,36.7025492 1,24 L1,24 L1,24 C1,11.2974508 11.2974508,1 24,1 L24,1 Z">
								</path>
							</svg>
						</div> -->
					</button>
					<!-- </div> -->
				</div>
			</div>

			<div class="action_section">
				<button
					*ngIf="botDetailsData?.status=='draft' || botDetailsData?.status =='Published' || botDetailsData?.status=='Deprecated' "
					data-bs-toggle="modal" data-bs-target="#copyBot" type="titleimg" class="btn"><img
						src="../../../../assets/img/teambox/copy.svg" (click)="copyBot()"></button>
				<button *ngIf="botDetailsData?.status=='draft'" class="titleimg"><img
						src="../../../../assets/img/edit.png" data-bs-toggle="modal"
						data-bs-target="#editFlowModal"></button>
				<button class="buttonClass"
					*ngIf="botDetailsData?.status=='draft' || botDetailsData?.status=='Published' || botDetailsData?.status=='Deprecated'"
					data-bs-toggle="modal" data-bs-target="#viewFlowModal">View
					Bot</button>
				<button
					*ngIf="botDetailsData?.status=='draft' || botDetailsData?.status=='Published' || botDetailsData?.status=='Deprecated'"
					type="button" class="titleimg" data-bs-toggle="modal" data-bs-target="#deleteBotModal"><img
						src="../../../../assets/img/teambox/delete.svg"></button>
			</div>



		</div>
	</div>







</sb-layout-dashboard>









<ng-template #filterBotId let-c="close" let-d="dismiss">
	<div class="modal-header filtercampaignheader">
		<div class="modal-header-left">
			<h4 class="modal-title" id="modal-basic-title">Filter</h4>
		</div>
		<div class="modal-header-right">
			<p class="close-box" aria-label="Close" (click)="d('Cross click')"><img
					src="assets/img/teambox/icon-close.svg"></p>
		</div>
	</div>
	<div class="modal-body filtercampaign">
		<p class="label">Bot Status</p>
		<div class="input_group">
			<label class="container" *ngFor="let status of filterListStatus ;let i = index">
				{{status.label}}
				<input [(ngModel)]="status.checked" type="checkbox" name="status" value={{status.value}}
					(click)="updateFilter($event,status)">
				<span class="checkmark"></span>
			</label>
		</div>

		<div class="input_group_btn mt-0">
			<button type="button" class="clear cancel-btn" aria-label="Close " (click)="clearFilters()">Clear
				All</button>
			<button type="button" class="date submit-btn" aria-label="Close" (click)="applyFilters()">Apply</button>
		</div>



	</div>

</ng-template>



<ng-template #dateRangeModal let-modal>
	<div class="modal-header">
		<h5 class="modal-title">Select Date Range</h5>

		<div class="modal-header-right">
			<p class="close-box" aria-label="Close" (click)="modal.dismiss('Cross click') "><img
					src="assets/img/teambox/icon-close.svg"></p>
		</div>
	</div>


	<div class="modal-body">
		<form [formGroup]="dateRangeForm">

			<!-- Current Billing Cycle -->
			<div class="form-check">
				<input type="radio" id="currentCycle" formControlName="dateOption" class="form-check-input"
					value="current" (change)="onDateOptionChange('7Days')" />
				<label class="form-check-label" for="currentCycle">Last 7 Days</label>
			</div>

			<!-- Last Billing Cycle -->
			<div class="form-check">
				<input type="radio" id="lastCycle" formControlName="dateOption" class="form-check-input" value="last"
					(change)="onDateOptionChange('30Days')" />
				<label class="form-check-label" for="lastCycle">Last 30 Days</label>
			</div>

			<!-- Custom Range -->
			<div class="form-check">
				<input type="radio" id="customRange" formControlName="dateOption" class="form-check-input"
					value="custom" (change)="onDateOptionChange('custom')" />
				<label class="form-check-label" for="customRange">Custom Range</label>
			</div>

			<!-- Date Pickers for Custom Range -->
			<div *ngIf="showDatePickers">
				<label>From Date:</label>
				<input type="date" class="form-control" formControlName="fromDate" [max]="maxSelectableDate"
					(change)="validateDate()" />

				<label>To Date:</label>
				<input type="date" class="form-control" formControlName="toDate" [max]="maxSelectableDate"
					(change)="validateDate()" />

				<div *ngIf="dateError" class="text-danger">{{ dateError }}</div>
			</div>

		</form>
	</div>

	<div class="modal-footer">
		<button type="button" class="cancel-btn" (click)="modal.dismiss('Cancel click')">Cancel</button>
		<button type="button" class="account-btn" [disabled]="!dateRangeForm.valid || dateError"
			(click)="confirmAndExport(modal)">Confirm and Export</button>
	</div>
</ng-template>








<div class="modal fade" tabindex="-1" id="createBotModal" data-bs-backdrop="static" role="dialog">
	<div class="addsmartreplies modal-dialog smartreplies-modal" role="document">
		<div class="modal-content smartreplies-modal" id="delete-tok">
			<div class="modal-body alertmessage" style="max-height: 90vh; overflow-y: auto;">
				<div class="container" id="addsmartreplies">
					<div class="bs-stepper row linear">
						<div class="head d-flex justify-content-between align-items-center" style="margin-bottom:20px;">

							<p class="m-0 heading">Create New Bot</p>
							<button type="button" class="btn5 btn-close" style="width: 40px;" data-bs-dismiss="modal"
								aria-label="Close">
								<img style="width: 10px;" src="assets/img/teambox/icon-close.svg"
									(click)="closeModalById('createBotModal')"></button>
						</div>

						<div class="p-0 bs-stepper-content">
							<div id="logins-part" class="content fade active dstepper-block" role="tabpanel"
								aria-labelledby="logins-part-trigger">
								<div class="box" [formGroup]="botBuilderForm">
									<h5>Bot Name<span class="text-danger"> * </span></h5>
									<input class="form-control" type="text" name="Title" id="Title"
										formControlName="name" placeholder="Enter title in max 20 character"
										maxlength="20" />
									<div class="text-danger dangerText"
										*ngIf="botBuilderForm.get('name')?.touched && botBuilderForm.get('name')?.invalid">
										<small *ngIf="botBuilderForm.get('name')?.errors?.['required']">Bot name is
											required.</small>
										<small *ngIf="botBuilderForm.get('name')?.errors?.['maxlength']">Max 20
											characters allowed.</small>
									</div>
									<h5>Description<span class="text-danger"> * </span></h5>
									<div class="form-floating ff">
										<textarea name="Description" id="Description" class="form-control" rows="4"
											cols="50" placeholder="Enter description in max 80 character"
											formControlName="botDescription" maxlength="80">
									</textarea>
									</div>
									<div class="text-danger dangerText"
										*ngIf="botBuilderForm.get('botDescription')?.touched && botBuilderForm.get('botDescription')?.invalid">
										<small
											*ngIf="botBuilderForm.get('botDescription')?.errors?.['required']">Description
											is required.</small>
										<small *ngIf="botBuilderForm.get('botDescription')?.errors?.['maxlength']">Max
											80 characters allowed.</small>
									</div>
									<h5>Channel<span class="text-danger"> * </span></h5>
									<input class="form-control bg-white select_box" type="text" name="Channel"
										id="Channel" formControlName="botChannel" (click)="toggleChannelOption()"
										style="cursor: pointer;" readonly placeholder="Select Channel" />
									<div class="text-danger dangerText"
										*ngIf="botBuilderForm.get('botChannel')?.touched && botBuilderForm.get('botChannel')?.invalid">
										<small *ngIf="botBuilderForm.get('botChannel')?.errors?.['required']">Channel is
											required.</small>
									</div>
									<div *ngIf="ShowChannelOption" (click)="stopPropagation($event)"
										class="popup-dialog ContactOption">
										<p *ngFor="let channel of channelOption ;let i = index" class="label"
											(click)="selectChannel(channel)" style="cursor: pointer;">
											<span>
												<img class="icon" src="/assets/img/teambox/whatsapp-icon-l.svg" />
												{{
												channel?.label === 'WhatsApp Official' ? 'WA API' :
												channel?.label === 'WhatsApp Web' ? 'WA Web' :
												channel?.label
												}} ({{channel?.connected_id}})
											</span>
										</p>
										<div *ngIf="ShowChannelOption" class="overlay"
											(click)="ShowChannelOption=false"></div>
									</div>

									<h5>Bot Timeout<span class="text-danger"> * </span></h5>
									<input type="time" class="form-control bg-white" formControlName="botTimeout">
									<div class="text-danger dangerText"
										*ngIf="botBuilderForm.get('botTimeout')?.touched && botBuilderForm.get('botTimeout')?.invalid">
										<small *ngIf="botBuilderForm.get('botTimeout')?.errors?.['required']">Timeout is
											required.</small>
									</div>

									<div classs="advance_option">
										<h6 (click)="toggleAdvanceOption()">Advance Option &nbsp; <img class="icons"
												src="../../../../assets/img/teambox/dropdown.svg" /></h6>
										<!-- <div *ngIf="showAdvanceOption">  -->

										<h5 *ngIf="showAdvanceOption">Drop-off Message<span
												class="text-muted">(Optional)</span></h5>
										<!-- <div class="child-interaction-2" *ngIf="showAdvanceOption"> -->
										<div class="child-interaction-2"
											[style.display]="showAdvanceOption ? 'block' : 'none'">

											<div class="conversation_inout_area">

												<div class="input-area">
													<ejs-richtexteditor id='defaultRTE' #chatEditor
														[toolbarSettings]='tools' [width]='0'
														placeholder="Type Message..."
														[pasteCleanupSettings]="pasteCleanupSettings"
														formControlName="dropOfMessage"> </ejs-richtexteditor>
													<!-- <button id="add-action-dropdown" type="button"><img
															src="assets/img/teambox/add.svg">Bot var</button> -->

												</div>
											</div>
										</div>
										<div *ngIf="showAdvanceOption">


											<h5>Add Action <span class="text-muted">(Optional)</span></h5>

											<div class="form-group position-relative">
												<input class="form-control bg-white select_box" type="text"
													name="advanceAction" placeholder="Select advance Action"
													[value]="getAdvanceActionDisplayValue()"
													(click)="toggleAdvanceAction()" readonly style="cursor: pointer;" />







												<div *ngIf="ShowAddAction" class="popup-dialog AssignAction"
													(click)="stopPropagation($event)">
													<p class="label">Add Action</p>
													<p class="d-flex justify-content-around"
														*ngFor="let assignAction of assignActionList; let m = index"
														(click)="!isOptionDisabled(assignAction.value) && toggleAssignOption(m)"
														[ngClass]="{'disabled-option': isOptionDisabled(assignAction.value),'selected-option': selectedExclusiveAction === assignAction.value}">
														<span>{{assignAction.name}}</span><img class="pr-3 arrow-sign"
															*ngIf="assignAction?.children"
															src="../../../../assets/img/arrow-sign.svg" />
													</p>
													<!-- [ngClass]="{'fade-out': assignAction.name == 'Assign Conversation' && assignedAgentList.length > 0 && checkList(), 'disabled-option': isOptionDisabled(assignAction.value)}"> -->
													<div *ngIf="ShowAddAction" class="overlay"
														(click)="closeAddAction()"></div>
												</div>



												<div *ngIf="ShowAssignOption && agentsList.length > 0"
													(click)="stopPropagation($event)" class="popup-dialog AssignOption"
													[class.disabled]="isAssigned">
													<p class="label">Assign To</p>
													<p class="d-flex align-items-center px-2 py-1"
														*ngFor="let agent of agentsList; let k = index"
														(click)="assignConversation(k)" (click)="closeAssignOption()">
														<span *ngIf="!agent.profileImg"
															class="text-capitalize initials mt-0 w-25"> {{
															agent.nameInitials }} </span>
														<img *ngIf="agent.profileImg" class="rounded-circle mt-0"
															style="width: 30px; height: 30px; margin-left: 11px;"
															src="{{agent.profileImg}}" />
														<span key={k} class="agentName mt-0 w-75">{{agent.name}}
															{{agent?.RoleName == 'Admin' ? '(Admin)' :''}}</span>
													</p>
													<div *ngIf="ShowAssignOption" class="overlay"
														(click)="closeAssignOption()"></div>
												</div>

												<div class="modal fade" tabindex="-1" id="addTagModal" #addTagModal
													role="dialog">
													<div class="modal-dialog" role="document">
														<div class="modal-content">
															<div class="row popup-dialog AddTag">
																<p *ngIf="!ShowRemoveTag && addTagList?.length > 0"
																	class="label">Add Tag</p>
																<p *ngIf="ShowRemoveTag" class="label">Remove Tag</p>

																<div class="d-flex addTag "
																	*ngFor="let AddTag of addTagList;let i = index">
																	<label class="container arddtag">
																		<input
																			[checked]="checkTagStatus(AddTag.TagName,0)"
																			type="checkbox" name="tags" class="m-0"
																			(change)="addTags(i,$event)" />
																		<span class="checkmark oops"></span>
																	</label>
																	<div class="dots d-flex align-items-center">
																		<div class="color-dots"
																			[style.background]="AddTag.TagColour"></div>
																		<span
																			class="fix-dots px-2 text-capitalize flex-grow-1 font-weight-normal">{{AddTag.TagName}}</span>
																	</div>
																</div>
																<div class="p-4" *ngIf="!addTagList?.length">
																	<p>No Data Available.</p>
																</div>
															</div>
														</div>
													</div>
												</div>

												<div class="modal fade" tabindex="-1" id="RemoveTagModal"
													#RemoveTagModal role="dialog">
													<div class="modal-dialog" role="document">
														<div class="modal-content">
															<div class="row popup-dialog AddTag">
																<p *ngIf="!ShowRemoveTag && removeTagList?.length > 0"
																	class="label">Remove Tag</p>
																<p *ngIf="ShowRemoveTag" class="label">Remove Tag</p>

																<div class="d-flex addTag "
																	*ngFor="let AddTag of removeTagList;let i = index">
																	<label class="container arddtag">
																		<input
																			[checked]="checkTagStatus(AddTag.TagName,1)"
																			type="checkbox" name="tags" class="m-0"
																			(change)="RemoveTags(i,$event)" />
																		<span class="checkmark oops"></span>
																	</label>
																	<div class="dots d-flex align-items-center">
																		<div class="color-dots"
																			[style.background]="AddTag.TagColour"></div>
																		<span
																			class="fix-dots px-2 text-capitalize flex-grow-1 font-weight-normal">{{AddTag.TagName}}</span>
																	</div>
																</div>
																<div class="p-4" *ngIf="!removeTagList?.length">
																	<p>No Data Available.</p>
																</div>
															</div>
														</div>
													</div>
												</div>

												<div class="modal fade" tabindex="-1" id="resolveAndOpen"
													#RemoveTagModal role="dialog">
													<div class="modal-dialog" role="document">
														<div class="modal-content">
															<div class="row popup-dialog AddTag">
																<p *ngIf="!ShowRemoveTag && converstationStatus?.length > 0"
																	class="label">Converstation Status</p>

																<div class="d-flex addTag "
																	*ngFor="let AddTag of converstationStatus;let i = index">
																	<label class="container arddtag">
																		<input [checked]="checkTagStatus(AddTag.name,2)"
																			type="checkbox" name="tags" class="m-0"
																			(change)="openConverstaion(i,$event)" />
																		<span class="checkmark oops"></span>
																	</label>
																	<div class="dots d-flex align-items-center">
																		<span
																			class="fix-dots px-2 text-capitalize flex-grow-1 font-weight-normal">{{AddTag.name}}</span>
																	</div>
																</div>
																<div class="p-4" *ngIf="!converstationStatus?.length">
																	<p>No Data Available.</p>
																</div>
															</div>
														</div>
													</div>
												</div>








												<div class="interactions">
													<div class="child-int-1 py-2">
														<div #chatSection class="child-interaction-1">
															<div
																*ngFor="let message of assignedAgentList; let i = index">
															

																<div class="d-flex justify-content-between align-items-center"
																	*ngIf="message.ActionID == 2">
																	<div class="col-8 assign-conversation">
																		<p class="m-0 py-1 px-2" id="msgbox-head1">
																			Action</p>
																		<div class="d-flex flex-wrap assign-container">

																			<p class="py-1 px-2 m-0" id="msgbox-body1">
																				<b>Conversation Assigned:</b></p>
																			<p class="py-1 m-0" id="msgbox-body2"
																				(input)="onActionEdit($event.target.innerHTML)">
																				{{message.Value}}</p>
																		</div>
																	</div>

																	<div class="col-4 assign-buttons ">
																		<button class="px-2 msg-edit-btn btn-2"
																			(click)="toggleEditable(i)"><img
																				src="assets/img/edit.png"></button>
																		<button class="px-1 msg-del-btn"
																			(click)="removeAction(i)"><img
																				src="assets/img/delete.png"></button>
																	</div>
																</div>


																<div class="d-flex justify-content-between align-items-center"
																	*ngIf="message.ActionID == 1">
																	<div class="col-8 add-tag">
																		<p id="msgbox-head1">Action</p>
																		<div class="d-flex flex-wrap assign-container">
																			<p class="p-1 m-0" id="msgbox-body1"><b>Add
																					Tags: </b>
																				<span class="pl-1"
																					*ngFor="let item of message.Value; let last = last">{{
																					item }}
																					<span *ngIf="!last">,</span>
																				</span>
																			</p>
																		</div>
																	</div>
																	<div class="col-4 assign-buttons">
																		<button class="px-2 msg-edit-btn"
																			(click)="toggleRemoveTag('addTag')"><img
																				src="assets/img/edit.png"></button>
																		<button class="px-1 msg-del-btn"
																			(click)="removeAddTag(i)"><img
																				src="assets/img/delete.png"></button>
																	</div>
																</div>
																<div class="d-flex justify-content-between align-items-center"
																	*ngIf="message.ActionID == 3">
																	<div class="col-8 add-tag">
																		<p id="msgbox-head1">Action</p>
																		<div class="d-flex flex-wrap assign-container">
																			<p class="p-1 m-0" id="msgbox-body1"><b>Remove
																					Tags: </b>
																				<span class="pl-1"
																					*ngFor="let item of message.Value; let last = last">{{
																					item }}
																					<span *ngIf="!last">,</span>
																				</span>
																			</p>
																		</div>
																	</div>
																	<div class="col-4 assign-buttons">
																		<button class="px-2 msg-edit-btn"
																			(click)="toggleRemoveTag('RemoveTag')"><img
																				src="assets/img/edit.png"></button>
																		<button class="px-1 msg-del-btn"
																			(click)="removeAddTag(i)"><img
																				src="assets/img/delete.png"></button>
																	</div>
																</div>

															</div>


														</div>
													</div>

												



								
											

												</div>







										
											</div>


										</div>
									</div>
								</div>
								<div class="title err-msg">
									<span id="title-err-msg"></span>
									<button type="button" class="btn5 btn-block col-2" (click)="submitBotForm()">Save
										and Next</button>
								</div>

							</div>

						</div>
					</div>

				</div>



			</div>
		</div>
	</div>
</div>



<div class="modal fade" tabindex="-1" id="editFlowModal" data-bs-backdrop="static" role="dialog">
	<div class="addsmartreplies modal-dialog smartreplies-modal" role="document">
		<div class="modal-content smartreplies-modal" id="edit-modal-tok">
			<div class="modal-body alertmessage" style="max-height: 90vh; overflow-y: auto;">
				<div class="container" id="edit-smartreplies">
					<div class="bs-stepper row linear">
						<div class="head d-flex justify-content-between align-items-center" style="margin-bottom:20px;">
							<p class="m-0 heading">Edit Bot</p>
							<button type="button" class="btn5 btn-close" style="width: 40px;" data-bs-dismiss="modal"
								aria-label="Close">
								<img style="width: 10px;" src="assets/img/teambox/icon-close.svg">
							</button>
						</div>

						<div class="p-0 bs-stepper-content">
							<div id="logins-part" class="content fade active dstepper-block" role="tabpanel"
								aria-labelledby="logins-part-trigger">
								<div class="box" [formGroup]="botBuilderForm">
									<h5>Bot Name<span class="text-danger"> * </span></h5>
									<input class="form-control" type="text" formControlName="name" maxlength="20"
										placeholder="Enter title in max 20 character" />

									<h5>Description<span class="text-danger"> * </span></h5>
									<div class="form-floating ff">
										<textarea class="form-control" rows="4" formControlName="botDescription"
											maxlength="80"
											placeholder="Enter description in max 80 character"></textarea>
									</div>

									<h5>Channel<span class="text-danger"> * </span></h5>
									<input class="form-control bg-white select_box" type="text"
										formControlName="botChannel" (click)="toggleChannelOption()" readonly
										style="cursor: pointer;" placeholder="Select Channel" />
									<!-- Channel Dropdown Logic Same as Add -->

									<h5>Bot Timeout<span class="text-danger"> * </span></h5>
									<input type="time" class="form-control bg-white" formControlName="botTimeout" />

									<!-- Advance Option Same as Add Modal -->
									<!-- You can reuse the same HTML inside this div -->
									<div class="advance_option">
										<h6 (click)="toggleAdvanceOption()">Advance Option &nbsp;
											<img class="icons" src="../../../../assets/img/teambox/dropdown.svg" />
										</h6>

										<h5 *ngIf="showAdvanceOption">Drop-off Message<span
												class="text-muted">(Optional)</span></h5>
										<div class="child-interaction-2"
											[style.display]="showAdvanceOption ? 'block' : 'none'">
											<div class="conversation_inout_area">
												<div class="input-area">
													<ejs-richtexteditor id='editRTE' #chatEditor
														[toolbarSettings]='tools' [width]='0'
														placeholder="Type Message..."
														[pasteCleanupSettings]="pasteCleanupSettings"
														formControlName="dropOfMessage"> </ejs-richtexteditor>

												</div>
											</div>
										</div>

										<div *ngIf="showAdvanceOption">
											<h5>Advance Action <span class="text-muted">(Optional)</span></h5>
											<div class="form-group position-relative">
												<input class="form-control bg-white select_box" type="text"
													placeholder="Select advance Action"
													[value]="getAdvanceActionDisplayValue()"
													(click)="toggleAdvanceAction()" readonly style="cursor: pointer;" />

												<div *ngIf="showAdvanceAction && !showSubmenuPanel"
													class="popup-dialog advance-dropdown"
													(click)="stopPropagation($event)">
													<div *ngFor="let action of advanceActions" class="label"
														(click)="handleActionClick(action)">
														{{ action.name }}
														<span *ngIf="selectedAdvanceAction?.value === action.value"
															style="float:right;">✓</span>
														<span *ngIf="action.children" style="float:right;">›</span>
													</div>
												</div>

												<div *ngIf="showSubmenuPanel" class="submenu-panel-overlay">
													<div class="submenu-panel">
														<h5 class="submenu-title">{{ submenuTitle }}</h5>
														<input class="form-control my-2 submenu-search"
															placeholder="Search" [(ngModel)]="searchText" />
														<div class="agent-list">
															<div *ngFor="let child of filteredSubmenuOptions()"
																class="agent-item" (click)="selectAdvanceAction(child)">
																{{ child.name }}
																<span *ngIf="isChildSelected(child)"
																	class="selected-check">✓</span>
															</div>
														</div>
														<div class="submenu-footer">
															<button class="btn cancel-btn"
																(click)="backToMainDropdown()">Cancel</button>
															<button class="btn save-btn"
																(click)="confirmSelection()">Save</button>
														</div>
													</div>
												</div>
											</div>

											<div *ngIf="botBuilderForm.value.advanceAction?.selected?.length"
												class="mt-2 selected-items">
												<span *ngFor="let tag of botBuilderForm.value.advanceAction.selected"
													class="badge bg-success me-1">
													{{ tag.name }}
												</span>
											</div>
										</div>
									</div>

								</div>

								<div class="title err-msg mt-3">
									<span id="title-err-msg"></span>
									<button type="button" class="btn5 btn-block col-1"
										(click)="updateBotForm()">Update</button>
								</div>

							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>


<div class="modal fade" tabindex="-1" id="viewFlowModal" data-bs-backdrop="static" role="dialog">
	<div class="addsmartreplies modal-dialog smartreplies-modal" role="document">
		<div class="modal-content smartreplies-modal" id="view-modal-tok">
			<div class="modal-body alertmessage" style="max-height: 90vh; overflow-y: auto;">
				<div class="container" id="view-smartreplies">
					<div class="bs-stepper row linear">
						<div class="head d-flex justify-content-between align-items-center" style="margin-bottom:20px;">
							<p class="m-0 heading">View Bot</p>
							<button type="button" class="btn5 btn-close" style="width: 40px;" data-bs-dismiss="modal"
								aria-label="Close">
								<img style="width: 10px;" src="assets/img/teambox/icon-close.svg">
							</button>
						</div>

						<div class="p-0 bs-stepper-content">
							<div id="logins-part" class="content fade active dstepper-block" role="tabpanel">
								<div class="box" [formGroup]="botBuilderForm">
									<h5>Bot Name</h5>
									<input class="form-control" type="text" formControlName="name" maxlength="20"
										readonly />

									<h5>Description</h5>
									<div class="form-floating ff">
										<textarea class="form-control" rows="4" formControlName="botDescription"
											maxlength="80" readonly></textarea>
									</div>

									<h5>Channel</h5>
									<input class="form-control bg-white select_box" type="text"
										formControlName="botChannel" readonly />

									<h5>Bot Timeout</h5>
									<input type="time" class="form-control bg-white" formControlName="botTimeout"
										readonly />

									<div class="advance_option">
										<h6>Advance Option</h6>

										<h5>Drop-off Message</h5>
										<div class="child-interaction-2">
											<div class="conversation_inout_area">
												<div class="input-area">
													<ejs-richtexteditor id='viewRTE' [toolbarSettings]="{ items: [] }"
														[enabled]="false" [width]='0' formControlName="dropOfMessage">
													</ejs-richtexteditor>
												</div>
											</div>
										</div>

										<h5>Advance Action</h5>
										<div class="form-group">
											<input class="form-control bg-white select_box" type="text"
												[value]="getAdvanceActionDisplayValue()" readonly />
										</div>


									</div>

								</div>

							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>




<div class="modal fade" tabindex="-1" id="copyBot" data-bs-backdrop="static" role="dialog">
	<div class="addsmartreplies modal-dialog smartreplies-modal" role="document">
		<div class="modal-content smartreplies-modal" id="edit-modal-tok">
			<div class="modal-body alertmessage" style="max-height: 90vh; overflow-y: auto;">
				<div class="container" id="edit-smartreplies">
					<div class="bs-stepper row linear">
						<div class="head d-flex justify-content-between align-items-center" style="margin-bottom:20px;">
							<p class="m-0 heading">Copy Bot</p>
							<button type="button" class="btn5 btn-close" style="width: 40px;" data-bs-dismiss="modal"
								aria-label="Close">
								<img style="width: 10px;" src="assets/img/teambox/icon-close.svg">
							</button>
						</div>

						<div class="p-0 bs-stepper-content">
							<div id="logins-part" class="content fade active dstepper-block" role="tabpanel"
								aria-labelledby="logins-part-trigger">
								<div class="box" [formGroup]="botBuilderForm">
									<h5>Bot Name<span class="text-danger"> * </span></h5>
									<!-- <input class="form-control" type="text" formControlName="copyBotName" maxlength="20"
										placeholder="Enter title in max 20 character" /> -->

									<h5>Description<span class="text-danger"> * </span></h5>
									<div class="form-floating ff">
										<textarea class="form-control" rows="4" formControlName="botDescription"
											maxlength="80"
											placeholder="Enter description in max 80 character"></textarea>
									</div>

									<h5>Channel<span class="text-danger"> * </span></h5>
									<input class="form-control bg-white select_box" type="text"
										formControlName="botChannel" (click)="toggleChannelOption()" readonly
										style="cursor: pointer;" placeholder="Select Channel" />
									<!-- Channel Dropdown Logic Same as Add -->

									<h5>Bot Timeout<span class="text-danger"> * </span></h5>
									<input type="time" class="form-control bg-white" formControlName="botTimeout" />

									<!-- Advance Option Same as Add Modal -->
									<!-- You can reuse the same HTML inside this div -->
									<div class="advance_option">
										<h6 (click)="toggleAdvanceOption()">Advance Option &nbsp;
											<img class="icons" src="../../../../assets/img/teambox/dropdown.svg" />
										</h6>

										<h5 *ngIf="showAdvanceOption">Drop-off Message<span
												class="text-muted">(Optional)</span></h5>
										<div class="child-interaction-2"
											[style.display]="showAdvanceOption ? 'block' : 'none'">
											<div class="conversation_inout_area">
												<div class="input-area">
													<ejs-richtexteditor id='editRTE' #chatEditor
														[toolbarSettings]='tools' [width]='0'
														placeholder="Type Message..."
														[pasteCleanupSettings]="pasteCleanupSettings"
														formControlName="dropOfMessage"> </ejs-richtexteditor>

												</div>
											</div>
										</div>

										<div *ngIf="showAdvanceOption">
											<h5>Advance Action <span class="text-muted">(Optional)</span></h5>
											<div class="form-group position-relative">
												<input class="form-control bg-white select_box" type="text"
													placeholder="Select advance Action"
													[value]="getAdvanceActionDisplayValue()"
													(click)="toggleAdvanceAction()" readonly style="cursor: pointer;" />

												<div *ngIf="showAdvanceAction && !showSubmenuPanel"
													class="popup-dialog advance-dropdown"
													(click)="stopPropagation($event)">
													<div *ngFor="let action of advanceActions" class="label"
														(click)="handleActionClick(action)">
														{{ action.name }}
														<span *ngIf="selectedAdvanceAction?.value === action.value"
															style="float:right;">✓</span>
														<span *ngIf="action.children" style="float:right;">›</span>
													</div>
												</div>

												<div *ngIf="showSubmenuPanel" class="submenu-panel-overlay">
													<div class="submenu-panel">
														<h5 class="submenu-title">{{ submenuTitle }}</h5>
														<input class="form-control my-2 submenu-search"
															placeholder="Search" [(ngModel)]="searchText" />
														<div class="agent-list">
															<div *ngFor="let child of filteredSubmenuOptions()"
																class="agent-item" (click)="selectAdvanceAction(child)">
																{{ child.name }}
																<span *ngIf="isChildSelected(child)"
																	class="selected-check">✓</span>
															</div>
														</div>
														<div class="submenu-footer">
															<button class="btn cancel-btn"
																(click)="backToMainDropdown()">Cancel</button>
															<button class="btn save-btn"
																(click)="confirmSelection()">Save</button>
														</div>
													</div>
												</div>
											</div>

											<div *ngIf="botBuilderForm.value.advanceAction?.selected?.length"
												class="mt-2 selected-items">
												<span *ngFor="let tag of botBuilderForm.value.advanceAction.selected"
													class="badge bg-success me-1">
													{{ tag.name }}
												</span>
											</div>
										</div>
									</div>

								</div>

								<div class="title err-msg mt-3">
									<span id="title-err-msg"></span>
									<button type="button" class="btn5 btn-block col-2" (click)="copyBotForm()">Save And
										Next</button>
								</div>

							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>



<div class="modal fade" tabindex="-1" id="deleteBotModal" data-bs-backdrop="static" role="dialog">
	<div class="modal-dialog modal-dialog-centered" role="document">
		<div class="modal-content p-3">
			<div class="modal-header border-0">
				<h5 class="modal-title">Confirm Delete</h5>
				<!-- <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
          <img style="width: 10px;" src="assets/img/teambox/icon-close.svg" />
        </button> -->
			</div>
			<div class="modal-body">
				<p>Are you sure you want to delete this bot?</p>
			</div>
			<div class="modal-footer border-0 d-flex justify-content-end">
				<button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-danger" (click)="confirmDelete()">Delete</button>
			</div>
		</div>
	</div>
</div>